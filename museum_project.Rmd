---
title: "Museums"
output: flexdashboard::flex_dashboard
runtime: shiny
---

```{r global, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggspatial)
library(sf)
library(ggthemes)

museums <- read_csv("Data/museums_tidy.csv") 
museums_sf <- museums |> filter(!is.na(LONGITUDE)) |> filter(!is.na(LATITUDE)) |>  st_as_sf(coords = c("LONGITUDE", "LATITUDE"), remove = FALSE) |> st_set_crs(4326) 
mn_sf <- st_read("Data/shp_bdry_counties_in_minnesota/mn_county_boundaries.shp") |> st_transform(4326)
```


```{r}
mn_museums <- museums_sf |> 
  filter(DISCIPLINE != "ZAW") |> 
  filter(DISCIPLINE != "BOT") |> 
  filter(ADSTATE == "MN")

ggplot() +
  geom_sf(data = mn_sf) +
  geom_sf(data = mn_museums, size = 0.1) +
  labs(
    title = "Museums in Minnesota"
  ) +
  theme_map()
```

About
==========================

Column {data-width = 200}
-------------------------

**Background Information**

![](img/museum1.jpg) 

-------------------------

**Inputs and Outputs**

You can embed Shiny inputs and outputs in your document. Outputs are automatically updated whenever inputs change.  This demonstrates how a standard R plot can be made interactive by wrapping it in the Shiny `renderPlot` function. The `selectInput` and `sliderInput` functions create the input widgets used to drive the plot.


Base R
==========================

Inputs {.sidebar}
-------------------------

```{r, echo=FALSE}
inputPanel(
  selectInput("n_breaks", label = "Number of bins:",
              choices = c(10, 20, 35, 50), selected = 20),
  
  sliderInput("bw_adjust", label = "Bandwidth adjustment:",
              min = 0.2, max = 2, value = 1, step = 0.2)
)
```

Column 
-------------------------

### Geyser Eruption Duration

```{r echo = FALSE}
renderPlot({
  hist(faithful$eruptions, probability = TRUE, 
       breaks = as.numeric(input$n_breaks),
       xlab = "Duration (minutes)", 
       main = "Geyser eruption duration")
  
  dens <- density(faithful$eruptions, adjust = input$bw_adjust)
  lines(dens, col = "blue")
})
```


Tidyverse
==========================

Inputs {.sidebar}
-------------------------

```{r, echo=FALSE}
inputPanel(
  selectInput("n_breaks2", label = "Number of bins:",
              choices = c(5, 10, 15, 20, 25, 30), selected = 15),
  
  sliderInput("bw_adjust2", label = "Bandwidth adjustment:",
              min = 0.1, max = 3, value = 1.2, step = 0.1)
)
```

Column 
-------------------------

### Geyser Eruption Duration

```{r echo = FALSE}
renderPlot({
  ggplot(faithful, aes(x = eruptions)) +
    geom_histogram(aes(y = ..density..), 
                   bins = as.numeric(input$n_breaks2),
                   fill = "white", colour = "black") +
    geom_density(adjust = input$bw_adjust2, colour = "blue") +
    labs(x = "Duration (minutes)", 
         title = "Geyser eruption duration")
})
```



```{r, eval = FALSE, include = FALSE}
# First write code that works, then incorporate into renderPlot
ggplot(faithful, aes(x = eruptions)) +
  geom_histogram(aes(y = ..density..), 
                 bins = 15,
                 fill = "white", colour = "black") +
  geom_density(adjust = 1.2, colour = "blue") +
  labs(x = "Duration (minutes)", 
       title = "Geyser eruption duration")
```

